{
    "uid": "07DDA1D1419141A5",
    "isLoaded": true,
    "lastModificationTime": 1428415343746,
    "items": {
        "name": "Format Helpers",
        "type": "script",
        "parentId": "DB2D3154KEE4EA43BCSBC59ED3B462A07998",
        "order": 1,
        "content": "LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogKgogKiAgIFNjcmlwdDogRm9ybWF0IEhlbHBlcnMKICoKICogICAkJENPUFlSSUdIVCQkCiAqCiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICoKICogICBEZWZpbmVzIGZvcm1hdCBoZWxwZXJzIHVzZWQgaW4gc2NlbmUgY29tbWFuZHMgYW5kIHZpZXdzLgogKgogKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAqLwogCnZhciBnbG9iYWwgPSB0aGlzLndpbmRvdyB8fCBzZWxmOwoKaWYoIWdsb2JhbC5HUykgZ2xvYmFsLkdTID0geyAgfTsKaWYoIWdsb2JhbC5HUy5WTikgZ2xvYmFsLkdTLlZOID0geyBFQ0g6IHt9IH07CmlmKCFnbG9iYWwuR1MuRUNIKSBnbG9iYWwuR1MuRUNIID0ge30KaWYoIWdsb2JhbC5HUy5EQkgpIGdsb2JhbC5HUy5EQkggPSB7fQoKZ2xvYmFsLkdTLlZOLnByZXBhcmVQcmV2aWV3ID0gZnVuY3Rpb24oY29tbWFuZHMsIGN1cnJlbnRJbmRleCwgcHJldmlld0RhdGEpIHsKICAgIHZhciBwcmV2aWV3RGF0YSA9IHsgYmFja2dyb3VuZHM6IFtdIH0KICAgIHZhciBjdXJyZW50Q29tbWFuZCA9IGNvbW1hbmRzW2N1cnJlbnRJbmRleF07CiAgICB2YXIgY29tbWFuZCA9IG51bGw7CiAgICAKICAgIGZvcih2YXIgaSA9IGN1cnJlbnRJbmRleDsgaSA+PSAwOyBpLS0pCiAgICB7CiAgICAgICAgY29tbWFuZCA9IGNvbW1hbmRzW2ldOwogICAgICAgIAogICAgICAgIHN3aXRjaChjb21tYW5kLmlkKQogICAgICAgIHsKICAgICAgICAgICAgY2FzZSAidm4uQ2hhbmdlQmFja2dyb3VuZCI6CiAgICAgICAgICAgICAgICBpZighaXNWYXIoY29tbWFuZC5wYXJhbXMubGF5ZXIpICYmICFpc1Zhcihjb21tYW5kLnBhcmFtcy5ncmFwaGljKSAmJiAhcHJldmlld0RhdGEuYmFja2dyb3VuZHNbY29tbWFuZC5wYXJhbXMubGF5ZXJdKQogICAgICAgICAgICAgICAgICAgIHByZXZpZXdEYXRhLmJhY2tncm91bmRzW2NvbW1hbmQucGFyYW1zLmxheWVyXSA9IGNvbW1hbmQucGFyYW1zLmdyYXBoaWM7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAvKiBjYXNlICJ2bi5DaGFyYWN0ZXJKb2luU2NlbmUiOgogICAgICAgICAgICAgICAgaWYocHJldmlld0RhdGEuY2hhcmFjdGVycy53aGVyZShmdW5jdGlvbihjKXsgYyA9PSBjb21tYW5kLnBhcmFtcy5jaGFyYWN0ZXJJZCB9KS5sZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgICAgICBwcmV2aWV3RGF0YS5jaGFyYWN0ZXJzLnB1c2goY29tbWFuZC5wYXJhbXMuY2hhcmFjdGVySWQpOyovCiAgICAgICAgfQogICAgfQoKICAgIC8vcHJldmlld0RhdGEucHJldmlld0JhY2tncm91bmQgPSBwcmV2aWV3RGF0YS5iYWNrZ3JvdW5kc1swXTsKICAgIGN1cnJlbnRDb21tYW5kLnBhcmFtcy5wcmV2aWV3QmFja2dyb3VuZCA9IHsgbmFtZTogIiRsaXZlX3ByZXZpZXdfc25hcHNob3QiIH07IC8vcHJldmlld0RhdGEuYmFja2dyb3VuZHNbMF07Cn0KCmdsb2JhbC5HUy5WTi5wcm9jZXNzTWVzc2FnZVRva2VuID0gZnVuY3Rpb24ocCwgY29kZSwgdmFsdWUpIHsKICAgIHN3aXRjaChjb2RlKQogICAgewogICAgICAgIGNhc2UgIkUiOiAgLy8gQ2hhbmdlIEV4cHJlc3Npb24KICAgICAgICAgICAgcC5leHByZXNzaW9ucy5wdXNoKCh2YWx1ZXx8MSktMSkKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiQSI6IC8vIFBsYXkgQW5pbWF0aW9uCiAgICAgICAgICAgIHAuYW5pbWF0aW9ucy5wdXNoKCh2YWx1ZXx8MSktMSkKICAgICAgICAgICAgYnJlYWs7CiAgICB9Cn0KCmdsb2JhbC5HUy5WTi53cml0ZU1lc3NhZ2VEYXRhID0gZnVuY3Rpb24odiwgcCkgewogICAgdmFyIG1lc3NhZ2UgPSB2LmxjSWQgPyB2LmRlZmF1bHRUZXh0fHwiIiA6IHY7CiAgICB2YXIgdG9rZW5zID0gbWVzc2FnZS5zcGxpdCgvXHsoW0EtWl0rKTooWzAtOUlBVU5CU0NHTFAsOl0rKVx9fChcbikvZ20pOwogICAgdmFyIHRva2VuID0gbnVsbDsKICAgIHZhciB0ID0gMDsKICAgIAogICAgcC5leHByZXNzaW9ucyA9IFtdOwogICAgcC5hbmltYXRpb25zID0gW107CiAgICAKICAgIHdoaWxlKHQgPCB0b2tlbnMubGVuZ3RoKSAKICAgIHsKICAgICAgICB0b2tlbiA9IHRva2Vuc1t0XQogICAgICAgIAogICAgICAgIGlmKHQgJSA0ICE9PSAwICYmIHRva2VuKQogICAgICAgIHsKICAgICAgICAgICAgdmFyIHZhbHVlID0gIHRva2Vuc1t0KzFdOwogICAgICAgICAgICB2YWx1ZSA9IGlzTmFOKHZhbHVlKSA/IHZhbHVlIDogcGFyc2VJbnQodmFsdWUpOwogICAgICAgICAgICAKICAgICAgICAgICAgR1MuVk4ucHJvY2Vzc01lc3NhZ2VUb2tlbihwLCB0b2tlbiwgdmFsdWUpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0KysKICAgIH0KICAgIAogICAgcmV0dXJuIHY7Cn0KCi8qIExJVkUyRCAyLjEgUmVmZXJlbmNlCmdsb2JhbC5HUy5WTi5saXZlMkRNb3Rpb25MaXN0ID0gZnVuY3Rpb24oZCkKewogICAgdmFyIHppcCA9IG5ldyBKU1ppcChkLl9tb2RlbERhdGEpOwogICAgdmFyIHNldHRpbmdzID0gemlwLmZpbGUoInNldHRpbmdzLmpzb24iKTsKICAgIHZhciBtb3Rpb25zID0gW107CiAgICAKICAgIGlmKHNldHRpbmdzKQogICAgewogICAgICAgIHNldHRpbmdzID0gSlNPTi5wYXJzZShzZXR0aW5ncy5hc1RleHQoKSk7CiAgICAgICAgCiAgICAgICAgZm9yKHZhciBrIGluIHNldHRpbmdzLm1vdGlvbnMpCiAgICAgICAgewogICAgICAgICAgICB2YXIgZ3JvdXAgPSBzZXR0aW5ncy5tb3Rpb25zW2tdOwogICAgICAgICAgICAKICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGdyb3VwLmxlbmd0aDsgaSsrKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBtb3Rpb25zLnB1c2goZ3JvdXBbaV0uZmlsZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIHJldHVybiBtb3Rpb25zOwp9CgpnbG9iYWwuR1MuVk4ubGl2ZTJETW90aW9uR3JvdXBMaXN0ID0gZnVuY3Rpb24oZCkKewogICAgdmFyIHppcCA9IG5ldyBKU1ppcChkLl9tb2RlbERhdGEpOwogICAgdmFyIHNldHRpbmdzID0gemlwLmZpbGUoInNldHRpbmdzLmpzb24iKTsKICAgIHZhciBtb3Rpb25zID0gW107CiAgICAKICAgIGlmKHNldHRpbmdzKQogICAgewogICAgICAgIHNldHRpbmdzID0gSlNPTi5wYXJzZShzZXR0aW5ncy5hc1RleHQoKSk7CiAgICAgICAgCiAgICAgICAgZm9yKHZhciBrIGluIHNldHRpbmdzLm1vdGlvbnMpCiAgICAgICAgewogICAgICAgICAgICBtb3Rpb25zLnB1c2goayB8fCBsY3MoJ0M2Nzg2NjUwOEIzMUY2NEE1MTRCMzRBN0YxNDIyNzczNTlDQycpKQogICAgICAgIH0KICAgIH0KICAgIAogICAgcmV0dXJuIG1vdGlvbnM7Cn0KCmdsb2JhbC5HUy5WTi5saXZlMkRFeHByZXNzaW9uTGlzdCA9IGZ1bmN0aW9uKGQpCnsKICAgIHZhciB6aXAgPSBuZXcgSlNaaXAoZC5fbW9kZWxEYXRhKTsKICAgIHZhciBzZXR0aW5ncyA9IHppcC5maWxlKCJzZXR0aW5ncy5qc29uIik7CiAgICB2YXIgZXhwcmVzc2lvbnMgPSBbXTsKICAgIAogICAgaWYoc2V0dGluZ3MpCiAgICB7CiAgICAgICAgc2V0dGluZ3MgPSBKU09OLnBhcnNlKHNldHRpbmdzLmFzVGV4dCgpKTsKICAgICAgICAKICAgICAgICBpZihzZXR0aW5ncy5leHByZXNzaW9ucykKICAgICAgICAgICAgc2V0dGluZ3MuZXhwcmVzc2lvbnMuZm9yRWFjaChmdW5jdGlvbihleHApewogICAgICAgICAgICAgICAgZXhwcmVzc2lvbnMucHVzaChleHAubmFtZSB8fCBleHAuZmlsZSkKICAgICAgICAgICAgfSkKICAgIH0KICAgIAogICAgcmV0dXJuIGV4cHJlc3Npb25zOwp9CgoqLwpnbG9iYWwuR1MuVk4ubGl2ZTJETW90aW9uTGlzdCA9IGZ1bmN0aW9uKGQpCnsKICAgIHZhciB6aXAgPSBuZXcgSlNaaXAoZC5fbW9kZWxEYXRhKTsKICAgIHZhciBtb3Rpb25zID0gW107CiAgICAKICAgIGlmICh6aXAuZmlsZSgic2V0dGluZ3MuanNvbiIpKSAvLyBMSVZFMkQgMi4xCiAgICB7CiAgICAgICAgdmFyIHNldHRpbmdzID0gemlwLmZpbGUoInNldHRpbmdzLmpzb24iKQogICAgICAgIHNldHRpbmdzID0gSlNPTi5wYXJzZShzZXR0aW5ncy5hc1RleHQoKSk7CiAgICAgICAgICAgIAogICAgICAgIGZvcih2YXIgayBpbiBzZXR0aW5ncy5tb3Rpb25zKQogICAgICAgIHsKICAgICAgICAgICAgdmFyIGdyb3VwID0gc2V0dGluZ3MubW90aW9uc1trXTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBncm91cC5sZW5ndGg7IGkrKykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbW90aW9ucy5wdXNoKGdyb3VwW2ldLmZpbGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgZWxzZSAvLyBMSVZFMkQgNC4wCiAgICB7CiAgICAgICAgdmFyIHNldHRpbmdzID0gemlwLmZpbGUoLy4rXC5tb2RlbDNcLmpzb24vKVswXTsgIAogICAgICAgIGlmKHNldHRpbmdzKQogICAgICAgIHsKICAgICAgICAgICAgc2V0dGluZ3MgPSBKU09OLnBhcnNlKHNldHRpbmdzLmFzVGV4dCgpKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvcih2YXIgayBpbiBzZXR0aW5ncy5GaWxlUmVmZXJlbmNlcy5Nb3Rpb25zKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBzZXR0aW5ncy5GaWxlUmVmZXJlbmNlcy5Nb3Rpb25zW2tdOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgZ3JvdXAubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbW90aW9ucy5wdXNoKGsgKyAiXyIgKyBpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgcmV0dXJuIG1vdGlvbnM7Cn0KCmdsb2JhbC5HUy5WTi5saXZlMkRNb3Rpb25Hcm91cExpc3QgPSBmdW5jdGlvbihkKQp7CiAgICB2YXIgemlwID0gbmV3IEpTWmlwKGQuX21vZGVsRGF0YSk7CiAgICB2YXIgbW90aW9ucyA9IFtdOwogICAgdmFyIHNldHRpbmdzID0gemlwLmZpbGUoInNldHRpbmdzLmpzb24iKQogICAgaWYgKHNldHRpbmdzKSAvLyBMSVZFMkQgMi4xCiAgICB7CiAgICAgICAgc2V0dGluZ3MgPSBKU09OLnBhcnNlKHNldHRpbmdzLmFzVGV4dCgpKTsKICAgICAgICAKICAgICAgICBmb3IodmFyIGsgaW4gc2V0dGluZ3MubW90aW9ucykKICAgICAgICB7CiAgICAgICAgICAgIG1vdGlvbnMucHVzaChrIHx8IGxjcygnQzY3ODY2NTA4QjMxRjY0QTUxNEIzNEE3RjE0MjI3NzM1OUNDJykpCiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZihzZXR0aW5ncyA9IHppcC5maWxlKC8uK1wubW9kZWwzXC5qc29uLylbMF0pIC8vIExJVkUyRCA0LjAKICAgIHsKICAgICAgICBzZXR0aW5ncyA9IEpTT04ucGFyc2Uoc2V0dGluZ3MuYXNUZXh0KCkpOwogICAgICAgIAogICAgICAgIGZvcih2YXIgayBpbiBzZXR0aW5ncy5GaWxlUmVmZXJlbmNlcy5Nb3Rpb25zKQogICAgICAgIHsKICAgICAgICAgICAgbW90aW9ucy5wdXNoKGspOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcmV0dXJuIG1vdGlvbnM7Cn0KCmdsb2JhbC5HUy5WTi5saXZlMkRFeHByZXNzaW9uTGlzdCA9IGZ1bmN0aW9uKGQpCnsKICAgIHZhciB6aXAgPSBuZXcgSlNaaXAoZC5fbW9kZWxEYXRhKTsKICAgIHZhciBleHByZXNzaW9ucyA9IFtdOwogICAgdmFyIHNldHRpbmdzID0gemlwLmZpbGUoInNldHRpbmdzLmpzb24iKQogICAgaWYgKHNldHRpbmdzKSAvLyBMSVZFMkQgMi4xCiAgICB7CiAgICAgICAgc2V0dGluZ3MgPSBKU09OLnBhcnNlKHNldHRpbmdzLmFzVGV4dCgpKTsKICAgICAgICAKICAgICAgICBpZihzZXR0aW5ncy5leHByZXNzaW9ucykKICAgICAgICAgICAgc2V0dGluZ3MuZXhwcmVzc2lvbnMuZm9yRWFjaChmdW5jdGlvbihleHApewogICAgICAgICAgICAgICAgZXhwcmVzc2lvbnMucHVzaChleHAubmFtZSB8fCBleHAuZmlsZSkKICAgICAgICAgICAgfSkKICAgIH0KICAgIGVsc2UgaWYgKHNldHRpbmdzID0gemlwLmZpbGUoLy4rXC5tb2RlbDNcLmpzb24vKVswXSkKICAgIHsKICAgICAgICBzZXR0aW5ncyA9IEpTT04ucGFyc2Uoc2V0dGluZ3MuYXNUZXh0KCkpOwogICAgICAgIAogICAgICAgIGlmKHNldHRpbmdzLkZpbGVSZWZlcmVuY2VzLkV4cHJlc3Npb25zKQogICAgICAgICAgICBzZXR0aW5ncy5GaWxlUmVmZXJlbmNlcy5FeHByZXNzaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGV4cCl7CiAgICAgICAgICAgICAgICBleHByZXNzaW9ucy5wdXNoKGV4cC5OYW1lIHx8IGV4cC5GaWxlKQogICAgICAgICAgICB9KQogICAgfQogICAgCiAgICByZXR1cm4gZXhwcmVzc2lvbnM7Cn0KCmdsb2JhbC5HUy5WTi5kYXRhYmFzZVBhcmFtTGlzdCA9IGZ1bmN0aW9uKGNvbGxlY3Rpb24sIGlkKQp7CiAgICB2YXIgciA9IHJlY29yZChjb2xsZWN0aW9uLCBpZCk7CiAgICB2YXIgcmVzdWx0ID0gW3sgbmFtZTogbGNzKCdEN0RDOTExREtDQ0I5QTRERTlTQkUyNkVCRkNDQTRDQjA4MjYnKSwgYWxpYXM6IHsgbmFtZTogbGNzKCdEN0RDOTExREtDQ0I5QTRERTlTQkUyNkVCRkNDQTRDQjA4MjYnKSB9IH1dOwogICAgCiAgICBpZihyICYmIHIucGFyYW1zKQogICAgewogICAgICAgIHJlc3VsdCA9IHIucGFyYW1zLnNlbGVjdChmdW5jdGlvbihwKSB7IHJldHVybiB7IG5hbWU6IHAubmFtZSwgYWxpYXM6IHAgfX0pOwogICAgfQogICAgCiAgICByZXR1cm4gcmVzdWx0Owp9CiAgICAgICAgIAoKZ2xvYmFsLkdTLlZOLnByZWRlZmluZWRPYmplY3RQb3NpdGlvbkxpc3QgPSBmdW5jdGlvbihpbmNsdWRlRGVmYXVsdCkKewogICAgdmFyIHIgPSByZWNvcmQoInN5c3RlbSIsIDApOwogICAgdmFyIHJlc3VsdCA9IFt7IG5hbWU6IGxjcygnRDdEQzkxMURLQ0NCOUE0REU5U0JFMjZFQkZDQ0E0Q0IwODI2JyksIGFsaWFzOiB7IG5hbWU6IGxjcygnRDdEQzkxMURLQ0NCOUE0REU5U0JFMjZFQkZDQ0E0Q0IwODI2JykgfSB9XTsKICAgIAogICAgaWYociAmJiByLm9iamVjdFBvc2l0aW9ucykKICAgIHsKICAgICAgICByZXN1bHQgPSByLm9iamVjdFBvc2l0aW9ucy5zZWxlY3QoZnVuY3Rpb24ocCwgaSkgeyByZXR1cm4geyBuYW1lOiBwLm5hbWUsIGFsaWFzOiBpIH0gfSk7CiAgICB9CiAgICAKICAgIGlmKGluY2x1ZGVEZWZhdWx0KQogICAgICAgIHJlc3VsdC5zcGxpY2UoMCwgMCwgeyBuYW1lOiBsY3MoJ1AxMTMnKSwgYWxpYXM6IC0xIH0pCiAgICAKICAgIHJldHVybiByZXN1bHQ7Cn0KICAgICAgICAgICAgIApnbG9iYWwuR1MuVk4udGV4dEZvclByZWRlZmluZWRPYmplY3RQb3NpdGlvbiA9IGZ1bmN0aW9uKGlkKQp7CiAgICB2YXIgciA9IHJlY29yZCgic3lzdGVtIiwgMCk7CiAgICB2YXIgcG9zaXRpb24gPSByLm9iamVjdFBvc2l0aW9uc1tpZF07CiAgICAKICAgIGlmKGlkID09IC0xKQogICAgICAgIHJldHVybiBsY3MoJ1AxMTMnKQogICAgZWxzZQogICAgICAgIHJldHVybiBwb3NpdGlvbiA/IHBvc2l0aW9uLm5hbWUgOiBsY3MoJ0M2QUU4MTczMEY1NjE1NDg5Mjk4QjE2NzlGQkIwRDI5MEYyMycpCn0KCmdsb2JhbC5HUy5WTi5yZXNvdXJjZUZvckV4cHJlc3Npb24gPSBmdW5jdGlvbihpZCkKewogICAgdmFyIHIgPSByZWNvcmQoJ2NoYXJhY3RlckV4cHJlc3Npb25zJywgaWQpOwogICAgdmFyIHJlc291cmNlID0gbnVsbDsKICAgIAogICAgaWYociAmJiByLmlkbGUgJiYgci5pZGxlLmxlbmd0aCA+IDApCiAgICAgICAgcmVzb3VyY2UgPSByLmlkbGVbMF0ucmVzb3VyY2U7CiAgICAgICAgCiAgICByZXR1cm4gcmVzb3VyY2U7Cn0KCmdsb2JhbC5HUy5WTi5yZXNvdXJjZUZvckNoYXJhY3RlciA9IGZ1bmN0aW9uKGlkKQp7CiAgICB2YXIgciA9IHJlY29yZCgiY2hhcmFjdGVycyIsIGlkKTsKICAgIHZhciByZXNvdXJjZSA9IG51bGw7CiAgICAKICAgIGlmKHIgJiYgci5kZWZhdWx0RXhwcmVzc2lvbklkICE9IG51bGwpCiAgICAgICAgcmVzb3VyY2UgPSBHUy5WTi5yZXNvdXJjZUZvckV4cHJlc3Npb24oci5kZWZhdWx0RXhwcmVzc2lvbklkKQogICAgCiAgICByZXR1cm4gcmVzb3VyY2U7Cn0KCmdsb2JhbC5HUy5WTi5leHByZXNzaW9uRm9yQ2hhcmFjdGVyID0gZnVuY3Rpb24oaWQpCnsKICAgIHZhciByID0gcmVjb3JkKCJjaGFyYWN0ZXJzIiwgaWQpOwogICAgdmFyIGV4cHJlc3Npb24gPSBudWxsOwogICAgCiAgICBpZihyLmV4cHJlc3Npb25zICYmIHIuZXhwcmVzc2lvbnMubGVuZ3RoID4gMCkKICAgICAgICBleHByZXNzaW9uID0gci5leHByZXNzaW9uc1swXQogICAgCiAgICByZXR1cm4gZXhwcmVzc2lvbjsKfQoKZ2xvYmFsLkdTLlZOLmV4cHJlc3Npb25JZEZvckNoYXJhY3RlciA9IGZ1bmN0aW9uKGlkKQp7CiAgICB2YXIgciA9IHJlY29yZCgiY2hhcmFjdGVycyIsIGlkKTsKICAgIHZhciBlaWQgPSAwOwogICAgCiAgICBpZihyICYmIHIuZGVmYXVsdEV4cHJlc3Npb25JZCAhPSBudWxsKQogICAgICAgIGVpZCA9IHIuZGVmYXVsdEV4cHJlc3Npb25JZDsKICAgIAogICAgcmV0dXJuIGVpZDsKfQoKZ2xvYmFsLkdTLlZOLmdyYXBoaWNGb3JBbmltYXRpb24gPSBmdW5jdGlvbihpZCkKewogICAgdmFyIHIgPSByZWNvcmQoImFuaW1hdGlvbnMiLCBpZCk7CiAgICB2YXIgZ3JhcGhpYyA9IG51bGw7CiAgICAKICAgIGlmKHIgJiYgci5ncmFwaGljKQogICAgICAgIGdyYXBoaWMgPSB7IG5hbWU6IHIuZ3JhcGhpYy5uYW1lLCBmb2xkZXJQYXRoOiByLmdyYXBoaWMuZm9sZGVyUGF0aCB9CiAgICBlbHNlCiAgICAgICAgZ3JhcGhpYyA9IHsgbmFtZTogIiIsIGZvbGRlclBhdGg6ICIiIH0KICAgICAgICAKICAgIHJldHVybiBncmFwaGljOwp9CgpnbG9iYWwuR1MuREJILmRhdGFTb3VyY2VGb3JTZWN0aW9uU2VsZWN0aW9uID0gZnVuY3Rpb24oZCkKewogICAgdmFyIHJlc3VsdCA9IFtdOwogICAgCiAgICBpZihkICYmIGQub2JqZWN0ICYmIGQub2JqZWN0LnBhcmVudE9iamVjdCkKICAgIHsKICAgICAgICB2YXIgZGVzY3JpcHRvciA9IGQub2JqZWN0LnBhcmVudE9iamVjdC5kZXNjcmlwdG9yIHx8IGQub2JqZWN0LnBhcmVudE9iamVjdDsKICAgICAgICByZXN1bHQgPSBkZXNjcmlwdG9yLnNlY3Rpb25zLndoZXJlKGZ1bmN0aW9uKHMpeyByZXR1cm4gcy51aWQgIT0gbnVsbCB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2VsZWN0KGZ1bmN0aW9uKHMpeyByZXR1cm4geyAibmFtZSI6IEdTUmVwbGFjZUxvY2FsaXplZFN0cmluZyhzLm5hbWUpLCAiYWxpYXMiOiB7ICJuYW1lIjogR1NSZXBsYWNlTG9jYWxpemVkU3RyaW5nKHMubmFtZSksICJ1aWQiOiBzLnVpZCB9IH0gfSk7CiAgICB9CiAgICAKICAgIHJldHVybiByZXN1bHQ7Cn0="
    },
    "summary": [
        "name",
        "type"
    ],
    "externalItems": []
}